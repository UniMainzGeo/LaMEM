| ------------------------------------------------------------------------- 
|                                      LaMEM                                
|                        Adjoint Gradient Framework Active                  
| ------------------------------------------------------------------------- 
| Adjoint parameters:  
|    Adjoint mode                             : Gradient descent (or Quasi-Newton) inversion  
|    Use Tao BLMVM (or LaMEM steepest descent): 1    
|    Gradient evaluation points               : several observation points  
|    Advect evaluation points with flow       : 0    
|    Objective function type                  : 0    
|    Objective function defined in input      : 1    
|    Maximum gradient descent iterations      : 200    
|    Maximum linesearch iterations            : 100    
|    Apply bounds                             : 0    
|    Tolerance (F/Fini)                       : 1.00000e-07  
|   1 : FD      log10    eta[0 ] = 21       ; bnd=[-        ; -        ]   
|   2 : FD               rho[1 ] = 3220     ; bnd=[-        ; -        ]   
|   Total number of adjoint gradients      : 0   
|   Total number of FD gradients           : 2   
| 
|   Total number of observation points     : 1   
|       [-200.000000,0.000000,-200.000000] has target velocity Vz=-1.00000
| 
| TAO: IOparam->Ab bounds = 0 
| 
| *************************************************************************
| TAO start iteration 1: 
| Currently employed parameters: 
|  eta[0]=2.1000000000e+01 
|  rho[1]=3.2200000000e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000846118 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729458282772e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450785549e+02 
    1 KSP Residual norm 3.995985446623e-02 
    2 KSP Residual norm 4.270007423661e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.002620038458e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0294975 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.507377154552e-10 
      |Div|_2   = 3.002555067660e-09 
   Momentum: 
      |mRes|_2  = 1.975249411217e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0180339 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.532486331284e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.661106123980e-01 
    1 KSP Residual norm 1.488937815848e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 1.225566363267e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0183243 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.331845525618e-09 
      |Div|_2   = 1.371277391007e-08 
   Momentum: 
      |mRes|_2  = 1.225489645245e-06 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0163555 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.112983 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  3.134796e-01 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.00005e+21 [Pa*s]  Bd = 4.99976e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000583913 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729458282772e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450785549e+02 
    1 KSP Residual norm 3.995985446623e-02 
    2 KSP Residual norm 4.270007423661e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.002620038458e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0353679 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.507377154552e-10 
      |Div|_2   = 3.002555067660e-09 
   Momentum: 
      |mRes|_2  = 1.975249411217e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0181217 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.532484022938e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.661107503218e-01 
    1 KSP Residual norm 1.488895469514e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 1.225475189738e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0206871 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.331705378813e-09 
      |Div|_2   = 1.371194609174e-08 
   Momentum: 
      |mRes|_2  = 1.225398475272e-06 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0166828 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.114368 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  3.134850e-01 
|  Brute force FD gradient   eta[ 0] = 2.536454e-01, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000595933 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729458684504e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450828509e+02 
    1 KSP Residual norm 3.995985780964e-02 
    2 KSP Residual norm 4.270613528995e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.003046943800e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0291198 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.508042351616e-10 
      |Div|_2   = 3.002981944285e-09 
   Momentum: 
      |mRes|_2  = 1.975826319370e-11 
--------------------------------------------------------------------------
Saving output ... done (0.017032 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.533778073156e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.661337586911e-01 
    1 KSP Residual norm 1.489155396143e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 1.225729779051e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0187999 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.332154239976e-09 
      |Div|_2   = 1.371481927264e-08 
   Momentum: 
      |mRes|_2  = 1.225653048372e-06 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0165644 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.103843 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  3.134583e-01 
|  Brute force FD gradient   rho[ 1] = -6.628286e-03, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000590263 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729458282772e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450785549e+02 
    1 KSP Residual norm 3.995985446623e-02 
    2 KSP Residual norm 4.270007423661e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.002620038458e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0298034 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.507377154552e-10 
      |Div|_2   = 3.002555067660e-09 
   Momentum: 
      |mRes|_2  = 1.975249411217e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167165 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.532486331284e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.661106123980e-01 
    1 KSP Residual norm 1.488937815848e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 1.225566363267e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0184446 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.331845525618e-09 
      |Div|_2   = 1.371277391007e-08 
   Momentum: 
      |mRes|_2  = 1.225489645245e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 7.233681012851e-03 
    1 KSP Residual norm 2.503127295026e-07 
    2 KSP Residual norm 9.081490534503e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 30 markers in 1.1068e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0175894 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.107345 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.1347963651e-01
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]            2.536454e-01 
|       FD     2:          rho[ 1]           -6.628286e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -2.13026e-01 
| 
| *************************************************************************
| TAO results of iteration 1: 
| 
| Parameter values: 
|   1 eta[0] =  2.10000e+01, gradient= 2.53645e-01
|   2 rho[1] =  3.22000e+03, gradient=-6.62829e-03
| 
| misfit           = 3.13479637e-01 
| misfit / misfit0 = 1.00000000e+00
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 2: 
| Currently employed parameters: 
|  eta[0]=2.0746354559e+01 
|  rho[1]=3.2200066283e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.57641e+20 [Pa*s]  Bd = 8.96634e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000590553 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729459109726e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450873981e+02 
    1 KSP Residual norm 3.995986134893e-02 
    2 KSP Residual norm 4.271250926716e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.003498854641e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0317922 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.508746463407e-10 
      |Div|_2   = 3.003433789790e-09 
   Momentum: 
      |mRes|_2  = 1.976967828400e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0168078 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.556914005356e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.641889201028e-01 
    1 KSP Residual norm 2.368541938685e-06 
    2 KSP Residual norm 6.784649486582e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.108774163357e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0241655 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.802855925127e-13 
      |Div|_2   = 1.709040468936e-12 
   Momentum: 
      |mRes|_2  = 2.108704908257e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0165281 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.1115 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  2.413464e-01 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.57667e+20 [Pa*s]  Bd = 8.96592e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000593283 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729459109726e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450873981e+02 
    1 KSP Residual norm 3.995986134893e-02 
    2 KSP Residual norm 4.271250926716e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.003498854641e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0265837 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.508746463407e-10 
      |Div|_2   = 3.003433789790e-09 
   Momentum: 
      |mRes|_2  = 1.976967828400e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167203 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.556912655305e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.641891085516e-01 
    1 KSP Residual norm 2.368492071149e-06 
    2 KSP Residual norm 6.786128828353e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.877318850731e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189653 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.802763496891e-13 
      |Div|_2   = 1.709029761220e-12 
   Momentum: 
      |mRes|_2  = 1.877241057786e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0165398 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.100977 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  2.413529e-01 
|  Brute force FD gradient   eta[ 0] = 3.135152e-01, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.57641e+20 [Pa*s]  Bd = 8.96634e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000590273 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729459511459e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450916941e+02 
    1 KSP Residual norm 3.995986469318e-02 
    2 KSP Residual norm 4.271858927134e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.003925839766e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0265861 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.509411614934e-10 
      |Div|_2   = 3.003860673400e-09 
   Momentum: 
      |mRes|_2  = 1.978650082813e-11 
--------------------------------------------------------------------------
Saving output ... done (0.016742 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.558208694069e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.642118164715e-01 
    1 KSP Residual norm 2.368904414632e-06 
    2 KSP Residual norm 6.785913214003e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.596543526252e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0241646 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.803399923567e-13 
      |Div|_2   = 1.709329979450e-12 
   Momentum: 
      |mRes|_2  = 1.596452019422e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
--------------------------------------------------------------------------
Saving output ... done (0.0166171 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.106282 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  2.413187e-01 
|  Brute force FD gradient   rho[ 1] = -8.602767e-03, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.57641e+20 [Pa*s]  Bd = 8.96634e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000597974 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729459109726e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910450873981e+02 
    1 KSP Residual norm 3.995986134893e-02 
    2 KSP Residual norm 4.271250926716e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.003498854641e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.032626 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.508746463407e-10 
      |Div|_2   = 3.003433789790e-09 
   Momentum: 
      |mRes|_2  = 1.976967828400e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167308 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.556914005356e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.641889201028e-01 
    1 KSP Residual norm 2.368541938685e-06 
    2 KSP Residual norm 6.784649486582e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.108774163357e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189792 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.802855925127e-13 
      |Div|_2   = 1.709040468936e-12 
   Momentum: 
      |mRes|_2  = 2.108704908257e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 7.347617687797e-03 
    1 KSP Residual norm 3.062107004567e-07 
    2 KSP Residual norm 1.183121894088e-11 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 35 markers in 1.1353e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0178247 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.111044 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.4134641776e-01
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]            3.135152e-01 
|       FD     2:          rho[ 1]           -8.602767e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -3.13503e-01 
| 
| *************************************************************************
| TAO results of iteration 2: 
| 
| Parameter values: 
|   1 eta[0] =  2.07464e+01, gradient= 3.13515e-01
|   2 rho[1] =  3.22001e+03, gradient=-8.60277e-03
| 
| misfit           = 2.41346418e-01 
| misfit / misfit0 = 7.69895041e-01
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 3: 
| Currently employed parameters: 
|  eta[0]=1.9731772795e+01 
|  rho[1]=3.2200331414e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.39228e+19 [Pa*s]  Bd = 9.27251e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000605733 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462417552e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451227717e+02 
    1 KSP Residual norm 3.995988889627e-02 
    2 KSP Residual norm 4.276246094001e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.007014128380e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0266937 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514223840856e-10 
      |Div|_2   = 3.006948850543e-09 
   Momentum: 
      |mRes|_2  = 1.981359377589e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167314 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.593984882663e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.551621239367e-01 
    1 KSP Residual norm 2.412787608724e-05 
    2 KSP Residual norm 5.876209709776e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.458184046924e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0190324 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.023159939896e-12 
      |Div|_2   = 2.945356163369e-11 
   Momentum: 
      |mRes|_2  = 2.458007586697e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 9.5887e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166912 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.102107 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  1.686304e-02 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.39253e+19 [Pa*s]  Bd = 9.27209e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000592603 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462417552e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451227717e+02 
    1 KSP Residual norm 3.995988889627e-02 
    2 KSP Residual norm 4.276246094001e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.007014128380e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0276322 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514223840856e-10 
      |Div|_2   = 3.006948850543e-09 
   Momentum: 
      |mRes|_2  = 1.981359377589e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167833 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.593984750030e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.551620329677e-01 
    1 KSP Residual norm 2.412677839119e-05 
    2 KSP Residual norm 5.874826256685e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.459459950154e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189777 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.021918311569e-12 
      |Div|_2   = 2.944919320434e-11 
   Momentum: 
      |mRes|_2  = 2.459283633791e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 9.5486e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166806 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.1029 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  1.685850e-02 
|  Brute force FD gradient   eta[ 0] = -2.297580e-01, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.39228e+19 [Pa*s]  Bd = 9.27251e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.04 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000592563 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462819290e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451270679e+02 
    1 KSP Residual norm 3.995989224373e-02 
    2 KSP Residual norm 4.276854703729e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.007441104396e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0267709 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514889094841e-10 
      |Div|_2   = 3.007375774811e-09 
   Momentum: 
      |mRes|_2  = 1.982285273532e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167285 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.595283303773e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.551836647420e-01 
    1 KSP Residual norm 2.413141956071e-05 
    2 KSP Residual norm 5.876675744108e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.460155371012e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0295373 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.023683826386e-12 
      |Div|_2   = 2.945658577128e-11 
   Momentum: 
      |mRes|_2  = 2.459979015982e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 9.5447e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166621 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.112464 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  1.689122e-02 
|  Brute force FD gradient   rho[ 1] = 8.753611e-03, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.39228e+19 [Pa*s]  Bd = 9.27251e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000595913 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462417552e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451227717e+02 
    1 KSP Residual norm 3.995988889627e-02 
    2 KSP Residual norm 4.276246094001e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.007014128380e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0274626 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514223840856e-10 
      |Div|_2   = 3.006948850543e-09 
   Momentum: 
      |mRes|_2  = 1.981359377589e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167943 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.593984882663e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.551621239367e-01 
    1 KSP Residual norm 2.412787608724e-05 
    2 KSP Residual norm 5.876209709776e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.458184046924e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0292394 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.023159939896e-12 
      |Div|_2   = 2.945356163369e-11 
   Momentum: 
      |mRes|_2  = 2.458007586697e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.462486451686e-03 
    1 KSP Residual norm 3.272784005749e-07 
    2 KSP Residual norm 1.627451094317e-11 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 30 markers in 1.1100e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0180625 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.116581 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.6863036330e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]           -2.297580e-01 
|       FD     2:          rho[ 1]            8.753611e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -1.17669e+00 
| 
| *************************************************************************
| TAO results of iteration 3: 
| 
| Parameter values: 
|   1 eta[0] =  1.97318e+01, gradient=-2.29758e-01
|   2 rho[1] =  3.22003e+03, gradient= 8.75361e-03
| 
| misfit           = 1.68630363e-02 
| misfit / misfit0 = 5.37930837e-02
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 4: 
| Currently employed parameters: 
|  eta[0]=2.0160922901e+01 
|  rho[1]=3.2200219268e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.44851e+20 [Pa*s]  Bd = 3.45181e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.02 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000605103 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461018399e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451078090e+02 
    1 KSP Residual norm 3.995987724100e-02 
    2 KSP Residual norm 4.274134579868e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.005527363895e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0265685 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.511906925750e-10 
      |Div|_2   = 3.005462003097e-09 
   Momentum: 
      |mRes|_2  = 1.982127797838e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167782 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.584570921889e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.574262642250e-01 
    1 KSP Residual norm 8.501088991298e-06 
    2 KSP Residual norm 2.287454386906e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.150470661845e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0191058 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.060143071761e-12 
      |Div|_2   = 9.256012898672e-12 
   Momentum: 
      |mRes|_2  = 7.149871558876e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 1 markers in 9.4267e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166163 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.10196 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  4.461677e-02 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.44858e+20 [Pa*s]  Bd = 3.45165e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.02 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000594033 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461018399e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451078090e+02 
    1 KSP Residual norm 3.995987724100e-02 
    2 KSP Residual norm 4.274134579868e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.005527363895e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0266384 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.511906925750e-10 
      |Div|_2   = 3.005462003097e-09 
   Momentum: 
      |mRes|_2  = 1.982127797838e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167223 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.584570562179e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.574265083501e-01 
    1 KSP Residual norm 8.500707849716e-06 
    2 KSP Residual norm 2.287348746159e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.196165742446e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189909 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.059992476079e-12 
      |Div|_2   = 9.255263909096e-12 
   Momentum: 
      |mRes|_2  = 7.195570540392e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 1 markers in 9.3885e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0167493 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.101867 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  4.462244e-02 
|  Brute force FD gradient   eta[ 0] = 2.813899e-01, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.44851e+20 [Pa*s]  Bd = 3.45181e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000594463 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461420135e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451121052e+02 
    1 KSP Residual norm 3.995988058710e-02 
    2 KSP Residual norm 4.274743085262e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.005954118760e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0265808 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.512572131488e-10 
      |Div|_2   = 3.005888911009e-09 
   Momentum: 
      |mRes|_2  = 1.979946369482e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167008 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.585868588293e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.574482529593e-01 
    1 KSP Residual norm 8.502362251077e-06 
    2 KSP Residual norm 2.287754013569e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.187594274475e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189569 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.060367718451e-12 
      |Div|_2   = 9.257051750400e-12 
   Momentum: 
      |mRes|_2  = 7.186998132305e-10 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 1 markers in 9.4731e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.016681 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.10171 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  4.458940e-02 
|  Brute force FD gradient   rho[ 1] = -8.501525e-03, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.44851e+20 [Pa*s]  Bd = 3.45181e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.02 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000598963 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461018399e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451078090e+02 
    1 KSP Residual norm 3.995987724100e-02 
    2 KSP Residual norm 4.274134579868e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.005527363895e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0335071 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.511906925750e-10 
      |Div|_2   = 3.005462003097e-09 
   Momentum: 
      |mRes|_2  = 1.982127797838e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167197 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.584570921889e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.574262642250e-01 
    1 KSP Residual norm 8.501088991298e-06 
    2 KSP Residual norm 2.287454386906e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.150470661845e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0190103 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.060143071761e-12 
      |Div|_2   = 9.256012898672e-12 
   Momentum: 
      |mRes|_2  = 7.149871558876e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.481898880384e-03 
    1 KSP Residual norm 2.946359047107e-07 
    2 KSP Residual norm 1.379081902077e-11 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 31 markers in 1.1283e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0180463 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.112422 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.4616770161e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]            2.813899e-01 
|       FD     2:          rho[ 1]           -8.501525e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -7.09678e-01 
| 
| *************************************************************************
| TAO results of iteration 4: 
| 
| Parameter values: 
|   1 eta[0] =  2.01609e+01, gradient= 2.81390e-01
|   2 rho[1] =  3.22002e+03, gradient=-8.50152e-03
| 
| misfit           = 4.46167702e-02 
| misfit / misfit0 = 1.42327491e-01
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 5: 
| Currently employed parameters: 
|  eta[0]=1.9880416846e+01 
|  rho[1]=3.2200292571e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.59306e+19 [Pa*s]  Bd = 6.58496e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000591373 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461932929e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175891e+02 
    1 KSP Residual norm 3.995988485873e-02 
    2 KSP Residual norm 4.275512453810e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006499111119e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0284637 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513421319287e-10 
      |Div|_2   = 3.006433848166e-09 
   Momentum: 
      |mRes|_2  = 1.980963799980e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167709 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591229043539e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550663454985e-01 
    1 KSP Residual norm 1.670778357235e-05 
    2 KSP Residual norm 4.164423873764e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.672700819104e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0236886 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.670886236385e-12 
      |Div|_2   = 1.991614823356e-11 
   Momentum: 
      |mRes|_2  = 1.672582248282e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4618e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166903 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.108396 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  1.660063e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.59341e+19 [Pa*s]  Bd = 6.58466e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000593013 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461932929e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175891e+02 
    1 KSP Residual norm 3.995988485873e-02 
    2 KSP Residual norm 4.275512453810e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006499111119e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0284277 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513421319287e-10 
      |Div|_2   = 3.006433848166e-09 
   Momentum: 
      |mRes|_2  = 1.980963799980e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167428 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591228855918e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550664135103e-01 
    1 KSP Residual norm 1.670693861550e-05 
    2 KSP Residual norm 4.164601913949e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.671792785417e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0199441 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.670912365657e-12 
      |Div|_2   = 1.991605501559e-11 
   Momentum: 
      |mRes|_2  = 1.671674151300e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4765e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166826 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.104556 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  1.617477e-06 
|  Brute force FD gradient   eta[ 0] = -2.142099e-03, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.59306e+19 [Pa*s]  Bd = 6.58496e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000596534 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462334667e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451218853e+02 
    1 KSP Residual norm 3.995988820567e-02 
    2 KSP Residual norm 4.276115810303e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006926070695e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0288693 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514086630734e-10 
      |Div|_2   = 3.006860771503e-09 
   Momentum: 
      |mRes|_2  = 1.981654425737e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167128 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.592527269299e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550879496267e-01 
    1 KSP Residual norm 1.671020574712e-05 
    2 KSP Residual norm 4.164725979658e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.675918065251e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0193813 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.671278825991e-12 
      |Div|_2   = 1.991849150739e-11 
   Momentum: 
      |mRes|_2  = 1.675799694215e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4613e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0167787 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.104558 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  1.905858e-06 
|  Brute force FD gradient   rho[ 1] = 7.633318e-05, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.59306e+19 [Pa*s]  Bd = 6.58496e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000591103 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461932929e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175891e+02 
    1 KSP Residual norm 3.995988485873e-02 
    2 KSP Residual norm 4.275512453810e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006499111119e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0288301 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513421319287e-10 
      |Div|_2   = 3.006433848166e-09 
   Momentum: 
      |mRes|_2  = 1.980963799980e-11 
--------------------------------------------------------------------------
Saving output ... done (0.016757 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591229043539e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550663454985e-01 
    1 KSP Residual norm 1.670778357235e-05 
    2 KSP Residual norm 4.164423873764e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.672700819104e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0196875 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.670886236385e-12 
      |Div|_2   = 1.991614823356e-11 
   Momentum: 
      |mRes|_2  = 1.672582248282e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 4.616675979353e-05 
    1 KSP Residual norm 2.679617029735e-09 
    2 KSP Residual norm 1.313968784660e-13 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 30 markers in 1.1062e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0180151 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.108102 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.6600631913e-06
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]           -2.142099e-03 
|       FD     2:          rho[ 1]            7.633318e-05 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -1.00176e+00 
| 
| *************************************************************************
| TAO results of iteration 5: 
| 
| Parameter values: 
|   1 eta[0] =  1.98804e+01, gradient=-2.14210e-03
|   2 rho[1] =  3.22003e+03, gradient= 7.63332e-05
| 
| misfit           = 1.66006319e-06 
| misfit / misfit0 = 5.29560137e-06
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 6: 
| Currently employed parameters: 
|  eta[0]=1.9889794596e+01 
|  rho[1]=3.2200289917e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.7588e+19 [Pa*s]  Bd = 6.44429e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000596223 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461899823e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451172350e+02 
    1 KSP Residual norm 3.995988458293e-02 
    2 KSP Residual norm 4.275461136909e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006464042292e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0266568 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513366528046e-10 
      |Div|_2   = 3.006398666818e-09 
   Momentum: 
      |mRes|_2  = 1.982659200281e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0168119 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591032607122e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550987461488e-01 
    1 KSP Residual norm 1.632835430736e-05 
    2 KSP Residual norm 4.078450871859e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.621329125536e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0276236 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.548165284061e-12 
      |Div|_2   = 1.942274450965e-11 
   Momentum: 
      |mRes|_2  = 1.621212783784e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4766e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166924 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.110543 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  4.283866e-05 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.75916e+19 [Pa*s]  Bd = 6.444e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000590952 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461899823e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451172350e+02 
    1 KSP Residual norm 3.995988458293e-02 
    2 KSP Residual norm 4.275461136909e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006464042292e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0266869 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513366528046e-10 
      |Div|_2   = 3.006398666818e-09 
   Momentum: 
      |mRes|_2  = 1.982659200281e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0168308 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591032415358e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550988230454e-01 
    1 KSP Residual norm 1.632757612087e-05 
    2 KSP Residual norm 4.078883775972e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.633090798770e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0190809 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.548281456324e-12 
      |Div|_2   = 1.942272060240e-11 
   Momentum: 
      |mRes|_2  = 1.632975295266e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.5299e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0168059 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.102219 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  4.305564e-05 
|  Brute force FD gradient   eta[ 0] = 1.090941e-02, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.7588e+19 [Pa*s]  Bd = 6.44429e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000601693 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462301560e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451215312e+02 
    1 KSP Residual norm 3.995988792984e-02 
    2 KSP Residual norm 4.276066160401e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006890894395e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0335991 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514031824857e-10 
      |Div|_2   = 3.006825590297e-09 
   Momentum: 
      |mRes|_2  = 1.981717252006e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167364 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.592330818467e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.551203583990e-01 
    1 KSP Residual norm 1.633074018768e-05 
    2 KSP Residual norm 4.079206135927e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.628226508773e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0206252 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.548806101755e-12 
      |Div|_2   = 1.942577329605e-11 
   Momentum: 
      |mRes|_2  = 1.628110623761e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4998e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0166623 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.110422 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  4.165453e-05 
|  Brute force FD gradient   rho[ 1] = -3.677395e-04, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.7588e+19 [Pa*s]  Bd = 6.44429e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000592633 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461899823e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451172350e+02 
    1 KSP Residual norm 3.995988458293e-02 
    2 KSP Residual norm 4.275461136909e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006464042292e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0269178 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513366528046e-10 
      |Div|_2   = 3.006398666818e-09 
   Momentum: 
      |mRes|_2  = 1.982659200281e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167949 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591032607122e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550987461488e-01 
    1 KSP Residual norm 1.632835430736e-05 
    2 KSP Residual norm 4.078450871859e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.621329125536e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189986 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.548165284061e-12 
      |Div|_2   = 1.942274450965e-11 
   Momentum: 
      |mRes|_2  = 1.621212783784e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.320674838154e-04 
    1 KSP Residual norm 1.344021118890e-08 
    2 KSP Residual norm 6.583326380191e-13 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 28 markers in 1.1126e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0182811 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.106016 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.2838657989e-05
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]            1.090941e-02 
|       FD     2:          rho[ 1]           -3.677395e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -9.91065e-01 
| 
| *************************************************************************
| TAO results of iteration 6: 
| 
| Parameter values: 
|   1 eta[0] =  1.98898e+01, gradient= 1.09094e-02
|   2 rho[1] =  3.22003e+03, gradient=-3.67740e-04
| 
| misfit           = 4.28386580e-05 
| misfit / misfit0 = 1.36655313e-04
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 7: 
| Currently employed parameters: 
|  eta[0]=1.9881954096e+01 
|  rho[1]=3.2200292136e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.61998e+19 [Pa*s]  Bd = 6.56169e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000586453 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461927502e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175310e+02 
    1 KSP Residual norm 3.995988481353e-02 
    2 KSP Residual norm 4.275504573329e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006493416085e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0330808 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513412345888e-10 
      |Div|_2   = 3.006428081175e-09 
   Momentum: 
      |mRes|_2  = 1.982053686246e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167202 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591196973273e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550713697307e-01 
    1 KSP Residual norm 1.664491160506e-05 
    2 KSP Residual norm 4.150660805870e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.666385931265e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0201405 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.650940223228e-12 
      |Div|_2   = 1.983577885068e-11 
   Momentum: 
      |mRes|_2  = 1.666267869760e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.5067e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0167053 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.109359 (sec) 
--------------------------------------------------------------------------
| ************************************************************************ 
|                       FINITE DIFFERENCE GRADIENTS                        
| ************************************************************************ 
| Reference objective function:  2.358866e-12 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.62033e+19 [Pa*s]  Bd = 6.56139e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000602813 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461927502e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175310e+02 
    1 KSP Residual norm 3.995988481353e-02 
    2 KSP Residual norm 4.275504573329e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006493416085e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0302014 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513412345888e-10 
      |Div|_2   = 3.006428081175e-09 
   Momentum: 
      |mRes|_2  = 1.982053686246e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0166794 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591196784979e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550714392342e-01 
    1 KSP Residual norm 1.664412846780e-05 
    2 KSP Residual norm 4.150199833617e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.668556775985e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189357 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.650488707233e-12 
      |Div|_2   = 1.983397943911e-11 
   Momentum: 
      |mRes|_2  = 1.668438889485e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.5624e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0167167 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.105333 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  2.275586e-10 
|  Brute force FD gradient   eta[ 0] = 1.132684e-05, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.61998e+19 [Pa*s]  Bd = 6.56169e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000592873 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729462329240e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451218272e+02 
    1 KSP Residual norm 3.995988816050e-02 
    2 KSP Residual norm 4.276109994149e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006920287524e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0304324 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.514077622641e-10 
      |Div|_2   = 3.006855003463e-09 
   Momentum: 
      |mRes|_2  = 1.981422909150e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167035 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.592495196680e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550929751484e-01 
    1 KSP Residual norm 1.664734548239e-05 
    2 KSP Residual norm 4.151315251716e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.663967339513e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0189875 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.651514796169e-12 
      |Div|_2   = 1.983855961147e-11 
   Momentum: 
      |mRes|_2  = 1.663849073239e-09 
--------------------------------------------------------------------------
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 2 markers in 9.4919e-04 s 
--------------------------------------------------------------------------
Saving output ... done (0.0168023 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.105698 (sec) 
--------------------------------------------------------------------------
|  Perturbed Misfit value     :  8.735766e-09 
|  Brute force FD gradient   rho[ 1] = 2.712214e-06, with eps=1.0000e-06 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion_FD.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [32, 2, 16]
   Number of cells                      :  1024
   Number of faces                      :  3680
   Maximum cell aspect ratio            :  9.37500
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.61998e+19 [Pa*s]  Bd = 6.56169e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.03 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000593583 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 9.729461927502e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.910451175310e+02 
    1 KSP Residual norm 3.995988481353e-02 
    2 KSP Residual norm 4.275504573329e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.006493416085e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0266082 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.513412345888e-10 
      |Div|_2   = 3.006428081175e-09 
   Momentum: 
      |mRes|_2  = 1.982053686246e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0167835 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 8.591196973273e-01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 1.550713697307e-01 
    1 KSP Residual norm 1.664491160506e-05 
    2 KSP Residual norm 4.150660805870e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.666385931265e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0190529 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.650940223228e-12 
      |Div|_2   = 1.983577885068e-11 
   Momentum: 
      |mRes|_2  = 1.666267869760e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.493771448124e-08 
    1 KSP Residual norm 3.187561912574e-12 
    2 KSP Residual norm 1.562853657288e-16 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 30 markers in 1.1121e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0180941 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.105385 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.3588656731e-12
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|       FD     1:   log10  eta[ 0]            1.132684e-05 
|       FD     2:          rho[ 1]            2.712214e-06 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [ -200.000;     0.000;  -200.000]  Vz -1.00000e+00  -1.00000e+00 
| 
| *************************************************************************
| TAO results of iteration 7: 
| 
| Parameter values: 
|   1 eta[0] =  1.98820e+01, gradient= 1.13268e-05
|   2 rho[1] =  3.22003e+03, gradient= 2.71221e-06
| 
| misfit           = 2.35886567e-12 
| misfit / misfit0 = 7.52478119e-12
| ------------------------------------------

| ------------------------------------------------------------------------- 
Tao Object: 1 MPI process
  type: lmvm
    Gradient steps: 1
  TaoLineSearch Object: 1 MPI process
    type: more-thuente
    maximum function evaluations=30
    tolerances: ftol=0.0001, rtol=1e-10, gtol=0.9
    total number of function evaluations=0
    total number of gradient evaluations=0
    total number of function/gradient evaluations=2
    Termination reason: 1
  convergence tolerances: gatol=1e-30,   steptol=0.,   gttol=1e-30
  Residual in Function/Gradient:=1.1647e-05
  convergence tolerances: function minimum=1e-06
  Objective value=2.35887e-12
  total number of iterations=2,                          (max: 2000)
  total number of function/gradient evaluations=7,      (max: 4000)
  Solution converged:    Minf --  f < fmin
| ------------------------------------------------------------------------- 
| ------------------------------------------------------------------------- 
| *                         INVERSION RESULT SUMMARY                      * 
| ------------------------------------------------------------------------- 
| Number of inversion iterations: 8
| F/Fini:
| 1.00000e+00
| 7.69895e-01
| 5.37931e-02
| 1.42327e-01
| 5.29560e-06
| 1.36655e-04
| 7.52478e-12
| 
| Final cost function:
| 2.35887e-12
| 
| Final Parameters: 
| eta[0] = 1.98820e+01
| rho[1] = 3.22003e+03
| ------------------------------------------------------------------------- 

| Adjoint computation was successful & took 3.00404 s                         	 
| ************************************************************************ 
