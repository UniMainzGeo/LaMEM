| ------------------------------------------------------------------------- 
|                                      LaMEM                                
|                        Adjoint Gradient Framework Active                  
| ------------------------------------------------------------------------- 
| Adjoint parameters:  
|    Adjoint mode                             : Gradient descent (or Quasi-Newton) inversion  
|    Use Tao BLMVM (or LaMEM steepest descent): 1    
|    Gradient evaluation points               : several observation points  
|    Advect evaluation points with flow       : 0    
|    Objective function type                  : 0    
|    Objective function defined in input      : 1    
|    Maximum gradient descent iterations      : 200    
|    Maximum linesearch iterations            : 100    
|    Apply bounds                             : 0    
|    Tolerance (F/Fini)                       : 1.00000e-08  
|   1 : adjoint log10    eta[0 ] = 21       ; bnd=[-        ; -        ]   
|   2 : adjoint          rho[1 ] = 3220     ; bnd=[-        ; -        ]   
|   Total number of adjoint gradients      : 2   
|   Total number of FD gradients           : 0   
| 
|   Total number of observation points     : 1   
|       [600.000000,0.000000,-20.000000] has target velocity Vx=-0.36000
| 
| TAO: IOparam->Ab bounds = 0 
| 
| *************************************************************************
| TAO start iteration 1: 
| Currently employed parameters: 
|  eta[0]=2.1000000000e+01 
|  rho[1]=3.2200000000e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00158025 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953289089e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785496583e+02 
    1 KSP Residual norm 5.651198477587e-02 
    2 KSP Residual norm 6.050373212903e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256530178230e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0848614 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285192024356e-10 
      |Div|_2   = 4.256437306769e-09 
   Momentum: 
      |mRes|_2  = 2.811781869428e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0329305 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.561046100812e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.351152880392e-01 
    1 KSP Residual norm 1.963770251585e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 2.168000840970e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0525787 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.086431103641e-09 
      |Div|_2   = 1.893580335784e-08 
   Momentum: 
      |mRes|_2  = 2.167918144625e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.396469132926e-03 
    1 KSP Residual norm 3.179500553225e-07 
    2 KSP Residual norm 6.679559966778e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 1.8788e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0300269 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.266785 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.1782342005e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.323656e-02 
|  adjoint     2:          rho[ 1]           -1.027791e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.05957e-01 
| 
| *************************************************************************
| TAO results of iteration 1: 
| 
| Parameter values: 
|   1 eta[0] =  2.10000e+01, gradient= 5.32366e-02
|   2 rho[1] =  3.22000e+03, gradient=-1.02779e-03
| 
| misfit           = 3.17823420e-02 
| misfit / misfit0 = 1.00000000e+00
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 2: 
| Currently employed parameters: 
|  eta[0]=2.0946763444e+01 
|  rho[1]=3.2200010278e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 8.84634e+20 [Pa*s]  Bd = 5.65206e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00115043 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953307081e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785515849e+02 
    1 KSP Residual norm 5.651198630346e-02 
    2 KSP Residual norm 6.050646191204e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256722609100e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.07167 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285426917841e-10 
      |Div|_2   = 4.256629614705e-09 
   Momentum: 
      |mRes|_2  = 2.813705818291e-11 
--------------------------------------------------------------------------
Saving output ... done (0.033678 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.562385781774e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.345028737996e-01 
    1 KSP Residual norm 2.156112222217e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 2.544670437615e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.05526 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.589811922697e-09 
      |Div|_2   = 2.206487064583e-08 
   Momentum: 
      |mRes|_2  = 2.544574773426e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.262423822949e-03 
    1 KSP Residual norm 3.335583158560e-07 
    2 KSP Residual norm 6.869281679230e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8705e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307635 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.246827 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.8878770553e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.571919e-02 
|  adjoint     2:          rho[ 1]           -1.087779e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.17838e-01 
| 
| *************************************************************************
| TAO results of iteration 2: 
| 
| Parameter values: 
|   1 eta[0] =  2.09468e+01, gradient= 5.57192e-02
|   2 rho[1] =  3.22000e+03, gradient=-1.08778e-03
| 
| misfit           = 2.88787706e-02 
| misfit / misfit0 = 9.08641992e-01
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 3: 
| Currently employed parameters: 
|  eta[0]=2.0733817220e+01 
|  rho[1]=3.2200051390e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.41773e+20 [Pa*s]  Bd = 9.22896e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113842 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953379049e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785592910e+02 
    1 KSP Residual norm 5.651199241439e-02 
    2 KSP Residual norm 6.051737820297e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.257491828036e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0642743 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.286366714042e-10 
      |Div|_2   = 4.257398869524e-09 
   Momentum: 
      |mRes|_2  = 2.813417087928e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0304501 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.566521318768e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.315686137612e-01 
    1 KSP Residual norm 3.217829400671e-06 
    2 KSP Residual norm 1.000700411213e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.863662530585e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0698148 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.330086094372e-13 
      |Div|_2   = 2.453335608529e-12 
   Momentum: 
      |mRes|_2  = 2.863557438487e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.576745462833e-03 
    1 KSP Residual norm 3.816018968153e-07 
    2 KSP Residual norm 7.124056108782e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8760e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0306226 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.249224 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.6377658666e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.954410e-02 
|  adjoint     2:          rho[ 1]           -1.227579e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.77632e-01 
| 
| *************************************************************************
| TAO results of iteration 3: 
| 
| Parameter values: 
|   1 eta[0] =  2.07338e+01, gradient= 5.95441e-02
|   2 rho[1] =  3.22001e+03, gradient=-1.22758e-03
| 
| misfit           = 1.63776587e-02 
| misfit / misfit0 = 5.15306854e-01
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 4: 
| Currently employed parameters: 
|  eta[0]=1.9882032323e+01 
|  rho[1]=3.2200215836e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.62136e+19 [Pa*s]  Bd = 6.56051e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.02 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00114435 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953666922e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785901163e+02 
    1 KSP Residual norm 5.651201686745e-02 
    2 KSP Residual norm 6.056105010401e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.260569022316e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0642954 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.290125858730e-10 
      |Div|_2   = 4.260475994854e-09 
   Momentum: 
      |mRes|_2  = 2.815477209691e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305703 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.573104723237e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.237890155217e-01 
    1 KSP Residual norm 2.320024089568e-05 
    2 KSP Residual norm 5.484755597695e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.498991534801e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0584696 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 6.140588200681e-12 
      |Div|_2   = 3.057750221310e-11 
   Momentum: 
      |mRes|_2  = 3.498857924662e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 9.259164117813e-03 
    1 KSP Residual norm 3.718263183798e-06 
    2 KSP Residual norm 6.387045970939e-11 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 8 markers in 1.9182e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0308784 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.237311 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.6508261299e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -1.734666e-01 
|  adjoint     2:          rho[ 1]            6.443479e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -6.32285e-01 
| 
| *************************************************************************
| TAO results of iteration 4: 
| 
| Parameter values: 
|   1 eta[0] =  1.98820e+01, gradient=-1.73467e-01
|   2 rho[1] =  3.22002e+03, gradient= 6.44348e-03
| 
| misfit           = 3.65082613e-02 
| misfit / misfit0 = 1.14869638e+00
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 5: 
| Currently employed parameters: 
|  eta[0]=2.0381439412e+01 
|  rho[1]=3.2200119420e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.4068e+20 [Pa*s]  Bd = 2.07745e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00114667 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953498140e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785720431e+02 
    1 KSP Residual norm 5.651200252868e-02 
    2 KSP Residual norm 6.053546798932e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258764900502e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0652311 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.287921806902e-10 
      |Div|_2   = 4.258671830193e-09 
   Momentum: 
      |mRes|_2  = 2.815529205393e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305346 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570479458616e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.257780234666e-01 
    1 KSP Residual norm 6.879281630250e-06 
    2 KSP Residual norm 2.024280597649e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.354912140096e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.046432 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.359156222899e-12 
      |Div|_2   = 7.135603948746e-12 
   Momentum: 
      |mRes|_2  = 7.354565990197e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.534342713706e-04 
    1 KSP Residual norm 1.440808618712e-07 
    2 KSP Residual norm 2.410261167115e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8748e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0310619 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.22635 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 5.1223059831e-04
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            1.653211e-02 
|  adjoint     2:          rho[ 1]           -3.976983e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.27748e-01 
| 
| *************************************************************************
| TAO results of iteration 5: 
| 
| Parameter values: 
|   1 eta[0] =  2.03814e+01, gradient= 1.65321e-02
|   2 rho[1] =  3.22001e+03, gradient=-3.97698e-04
| 
| misfit           = 5.12230598e-04 
| misfit / misfit0 = 1.61168298e-02
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 6: 
| Currently employed parameters: 
|  eta[0]=2.0102797457e+01 
|  rho[1]=3.2200174368e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1.26706e+20 [Pa*s]  Bd = 3.94614e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.02 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00115974 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953594330e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785823431e+02 
    1 KSP Residual norm 5.651201069985e-02 
    2 KSP Residual norm 6.055010095215e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259793097846e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0647034 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.289177829098e-10 
      |Div|_2   = 4.259700024321e-09 
   Momentum: 
      |mRes|_2  = 2.815917710930e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305091 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.572210848025e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.229363474951e-01 
    1 KSP Residual norm 1.334913096881e-05 
    2 KSP Residual norm 3.489376122717e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 1.867171412763e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0499064 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.280380470299e-12 
      |Div|_2   = 1.636017327140e-11 
   Momentum: 
      |mRes|_2  = 1.867099737393e-09 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.075301390946e-03 
    1 KSP Residual norm 1.078117402894e-06 
    2 KSP Residual norm 1.804086345139e-11 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 7 markers in 1.9104e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307756 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.229017 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 8.3099423904e-03
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -8.061540e-02 
|  adjoint     2:          rho[ 1]            2.386073e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -4.89905e-01 
| 
| *************************************************************************
| TAO results of iteration 6: 
| 
| Parameter values: 
|   1 eta[0] =  2.01028e+01, gradient=-8.06154e-02
|   2 rho[1] =  3.22002e+03, gradient= 2.38607e-03
| 
| misfit           = 8.30994239e-03 
| misfit / misfit0 = 2.61464130e-01
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 7: 
| Currently employed parameters: 
|  eta[0]=2.0325993950e+01 
|  rho[1]=3.2200130354e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.11833e+20 [Pa*s]  Bd = 2.36035e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00114331 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953517280e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785740927e+02 
    1 KSP Residual norm 5.651200415449e-02 
    2 KSP Residual norm 6.053842422727e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258969417636e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0656785 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288171694903e-10 
      |Div|_2   = 4.258876418197e-09 
   Momentum: 
      |mRes|_2  = 2.814524619585e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305784 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570895129126e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249714364269e-01 
    1 KSP Residual norm 7.821598704466e-06 
    2 KSP Residual norm 2.260385020942e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.722041467969e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0465275 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.631295413421e-12 
      |Div|_2   = 8.432741247646e-12 
   Momentum: 
      |mRes|_2  = 8.721633806603e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 4.718664218682e-05 
    1 KSP Residual norm 1.319652064956e-08 
    2 KSP Residual norm 2.196507914075e-13 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.8855e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0308084 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.226715 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.3637852427e-06
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            1.410128e-03 
|  adjoint     2:          rho[ 1]           -3.511346e-05 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.57386e-01 
| 
| *************************************************************************
| TAO results of iteration 7: 
| 
| Parameter values: 
|   1 eta[0] =  2.03260e+01, gradient= 1.41013e-03
|   2 rho[1] =  3.22001e+03, gradient=-3.51135e-05
| 
| misfit           = 3.36378524e-06 
| misfit / misfit0 = 1.05838180e-04
| ------------------------------------------

| 
| *************************************************************************
| TAO start iteration 8: 
| Currently employed parameters: 
|  eta[0]=2.0320823586e+01 
|  rho[1]=3.2200131387e+03 
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.09326e+20 [Pa*s]  Bd = 2.38862e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113501 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953519088e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785742863e+02 
    1 KSP Residual norm 5.651200430806e-02 
    2 KSP Residual norm 6.053861721326e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258988718510e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0699434 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288195304489e-10 
      |Div|_2   = 4.258895748018e-09 
   Momentum: 
      |mRes|_2  = 2.814092953123e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0307284 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570931884934e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249006232231e-01 
    1 KSP Residual norm 7.916541523446e-06 
    2 KSP Residual norm 2.283172588827e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.978158811559e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0641052 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.658823523421e-12 
      |Div|_2   = 8.563950486288e-12 
   Momentum: 
      |mRes|_2  = 8.977750359683e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 4.111083365530e-06 
    1 KSP Residual norm 1.157077449422e-09 
    2 KSP Residual norm 1.925302756575e-14 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.9003e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0306949 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.248694 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.5275403173e-08
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -1.227808e-04 
|  adjoint     2:          rho[ 1]            3.067710e-06 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.60227e-01 
| 
| *************************************************************************
| TAO results of iteration 8: 
| 
| Parameter values: 
|   1 eta[0] =  2.03208e+01, gradient=-1.22781e-04
|   2 rho[1] =  3.22001e+03, gradient= 3.06771e-06
| 
| misfit           = 2.52754032e-08 
| misfit / misfit0 = 7.95265597e-07
| ------------------------------------------

| ------------------------------------------------------------------------- 
Tao Object: 1 MPI process
  type: lmvm
    Gradient steps: 1
  TaoLineSearch Object: 1 MPI process
    type: more-thuente
    maximum function evaluations=30
    tolerances: ftol=0.0001, rtol=1e-10, gtol=0.9
    total number of function evaluations=0
    total number of gradient evaluations=0
    total number of function/gradient evaluations=1
    Termination reason: 1
  convergence tolerances: gatol=1e-30,   steptol=0.,   gttol=1e-30
  Residual in Function/Gradient:=0.000122819
  convergence tolerances: function minimum=1e-06
  Objective value=2.52754e-08
  total number of iterations=3,                          (max: 2000)
  total number of function/gradient evaluations=8,      (max: 4000)
  Solution converged:    Minf --  f < fmin
| ------------------------------------------------------------------------- 
| ------------------------------------------------------------------------- 
| *                         INVERSION RESULT SUMMARY                      * 
| ------------------------------------------------------------------------- 
| Number of inversion iterations: 9
| F/Fini:
| 1.00000e+00
| 9.08642e-01
| 5.15307e-01
| 1.14870e+00
| 1.61168e-02
| 2.61464e-01
| 1.05838e-04
| 7.95266e-07
| 
| Final cost function:
| 2.52754e-08
| 
| Final Parameters: 
| eta[0] = 2.03208e+01
| rho[1] = 3.22001e+03
| ------------------------------------------------------------------------- 

| Adjoint computation was successful & took 1.93376 s                         	 
| ************************************************************************ 
