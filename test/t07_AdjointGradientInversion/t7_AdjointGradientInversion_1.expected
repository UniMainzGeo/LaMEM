| ------------------------------------------------------------------------- 
|                                      LaMEM                                
|                        Adjoint Gradient Framework Active                  
| ------------------------------------------------------------------------- 
| Adjoint parameters:  
|    Adjoint mode                             : Gradient descent (or Quasi-Newton) inversion  
|    Use Tao BLMVM (or LaMEM steepest descent): 0    
|    Gradient evaluation points               : several observation points  
|    Advect evaluation points with flow       : 0    
|    Objective function type                  : 0    
|    Objective function defined in input      : 1    
|    Maximum gradient descent iterations      : 200    
|    Maximum linesearch iterations            : 100    
|    Apply bounds                             : 0    
|    Tolerance (F/Fini)                       : 1.00000e-08  
|    Not employing TAO, but instead our build-in gradient algorithm, with the following parameters: 
|     Linesearch factor (successful update)    : 1.10000e+00  
|     Linesearch factor (overstep)             : 4.00000e-01  
|     Maximum linesearch factor                : 5.00000e+00  
|     Scale for initial parameter update       : 1.00000e-01  
|   1 : adjoint log10    eta[0 ] = 21       ; bnd=[-        ; -        ]   
|   2 : adjoint          rho[1 ] = 3220     ; bnd=[-        ; -        ]   
|   Total number of adjoint gradients      : 2   
|   Total number of FD gradients           : 0   
| 
|   Total number of observation points     : 1   
|       [600.000000,0.000000,-20.000000] has target velocity Vx=-0.36000
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00165196 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953289089e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785496583e+02 
    1 KSP Residual norm 5.651198477587e-02 
    2 KSP Residual norm 6.050373212903e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256530178230e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0726121 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285192024356e-10 
      |Div|_2   = 4.256437306769e-09 
   Momentum: 
      |mRes|_2  = 2.811781869428e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0330756 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.561046100812e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.351152880392e-01 
    1 KSP Residual norm 1.963770251585e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 2.168000840970e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0518676 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.086431103641e-09 
      |Div|_2   = 1.893580335784e-08 
   Momentum: 
      |mRes|_2  = 2.167918144625e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.396469132926e-03 
    1 KSP Residual norm 3.179500553225e-07 
    2 KSP Residual norm 6.679559966778e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 1.8834e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0300412 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.255951 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.1782342005e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.323656e-02 
|  adjoint     2:          rho[ 1]           -1.027791e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.05957e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.323656e-02, [1]=-1.027791e-03 

| ------------------------------------------------------------------------ 
| 1. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.00000e+00
| 
| Fold = 1.00000e+100 
|    F = 3.17823e-02
| 
| 1 Diff parameter value = -2.10000e+00
| 2 Diff parameter value = 3.22000e+02
| 
| 1 Parameter value = 1.89000e+01
| 2 Parameter value = 3.54200e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 5.00000e+00
| LS factor for 2.Parameter = 5.00000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.94328e+18 [Pa*s]  Bd = 6.29463e-20 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3542. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113106 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.381750838666e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.737605410248e+02 
    1 KSP Residual norm 2.571084414294e-01 
    2 KSP Residual norm 2.661013152728e-04 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.148500085621e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0754478 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.172402664979e-07 
      |Div|_2   = 4.145784035181e-06 
   Momentum: 
      |mRes|_2  = 1.500922850687e-07 
--------------------------------------------------------------------------
Saving output ... done (0.0334344 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 7.184900751088e+02 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 4.026133102793e+01 
    1 KSP Residual norm 8.097683423867e-03 
    2 KSP Residual norm 4.635239148766e-07 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.220313051619e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0465363 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.974462152648e-09 
      |Div|_2   = 3.813905905942e-08 
   Momentum: 
      |mRes|_2  = 4.220140716355e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.885429160413e+00 
    1 KSP Residual norm 1.824544915944e-03 
    2 KSP Residual norm 3.456465353559e-08 
Actual time step : 0.05140 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 45 markers in 2.1568e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0334957 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.245285 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 9.7357846484e+01
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -4.110339e+01 
|  adjoint     2:          rho[ 1]            5.812966e-01 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.44209e+01 
| 
| AdjointOptimisation: Gradients. [0]=-4.110339e+01, [1]=5.812966e-01 

| - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|               LINE SEARCH IT 1                       
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.82577e+20 [Pa*s]  Bd = 6.38915e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113108 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953325073e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785535114e+02 
    1 KSP Residual norm 5.651198783105e-02 
    2 KSP Residual norm 6.050911991342e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256914576567e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0786602 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285661915409e-10 
      |Div|_2   = 4.256821932971e-09 
   Momentum: 
      |mRes|_2  = 2.808457161933e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0304131 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.563590442038e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.338414978860e-01 
    1 KSP Residual norm 2.373045055361e-06 
    2 KSP Residual norm 7.395559963162e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.463342523838e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.046801 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.691944161071e-13 
      |Div|_2   = 1.504594275201e-12 
   Momentum: 
      |mRes|_2  = 2.463296573568e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.115020855676e-03 
    1 KSP Residual norm 3.487342723009e-07 
    2 KSP Residual norm 7.019977909948e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8725e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0304369 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.240345 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.5856199577e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.776753e-02 
|  adjoint     2:          rho[ 1]           -1.141286e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.30861e-01 
| 
|    F = 2.585620e-02,  Fold = 3.178234e-02                      

| - - - - - - - - - - - - - - - - - - - - - - - - - - - 

| ------------------------------------------------------------------------ 
| 2. IT INVERSION RESULT: line search its = 1 ; F / FINI = 8.13540e-01
| 
| Fold = 3.17823e-02 
|    F = 2.58562e-02
| 
| 1 Diff parameter value = -1.15535e-01
| 2 Diff parameter value = 2.28257e-03
| 
| 1 Parameter value = 2.07780e+01
| 2 Parameter value = 3.22000e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.20000e+00
| LS factor for 2.Parameter = 2.20000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.9978e+20 [Pa*s]  Bd = 8.33639e-22 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00114527 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953365031e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785577900e+02 
    1 KSP Residual norm 5.651199122397e-02 
    2 KSP Residual norm 6.051527174670e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.257341918208e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0639754 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.286183607474e-10 
      |Div|_2   = 4.257249025835e-09 
   Momentum: 
      |mRes|_2  = 2.812366549798e-11 
--------------------------------------------------------------------------
Saving output ... done (0.03057 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.565805797369e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.322389656651e-01 
    1 KSP Residual norm 2.950118233752e-06 
    2 KSP Residual norm 9.189843844706e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.025971061953e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0486889 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.806864220558e-13 
      |Div|_2   = 2.144190430106e-12 
   Momentum: 
      |mRes|_2  = 3.025895092781e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.741663665711e-03 
    1 KSP Residual norm 3.756535989181e-07 
    2 KSP Residual norm 7.161126919810e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8713e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0305348 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.22719 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.9019648349e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.989479e-02 
|  adjoint     2:          rho[ 1]           -1.218837e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.63473e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.989479e-02, [1]=-1.218837e-03 

| ------------------------------------------------------------------------ 
| 3. IT INVERSION RESULT: line search its = 0 ; F / FINI = 5.98434e-01
| 
| Fold = 2.58562e-02 
|    F = 1.90196e-02
| 
| 1 Diff parameter value = -1.31769e-01
| 2 Diff parameter value = 2.68144e-03
| 
| 1 Parameter value = 2.06462e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.42000e+00
| LS factor for 2.Parameter = 2.42000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 4.42816e+20 [Pa*s]  Bd = 1.12914e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113749 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953411971e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785628162e+02 
    1 KSP Residual norm 5.651199521016e-02 
    2 KSP Residual norm 6.052235799291e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.257843602493e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0729482 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.286796594782e-10 
      |Div|_2   = 4.257750763348e-09 
   Momentum: 
      |mRes|_2  = 2.811726340530e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0308983 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.567786554357e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.301659533533e-01 
    1 KSP Residual norm 3.845883762007e-06 
    2 KSP Residual norm 1.189175287013e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.496405199302e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0499536 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 5.559165866358e-13 
      |Div|_2   = 3.202017018515e-12 
   Momentum: 
      |mRes|_2  = 3.496258575449e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.205989855631e-03 
    1 KSP Residual norm 3.804385851173e-07 
    2 KSP Residual norm 6.833520126799e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8903e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307656 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.237668 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.1276181336e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.624777e-02 
|  adjoint     2:          rho[ 1]           -1.194090e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -2.08677e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.624777e-02, [1]=-1.194090e-03 

| ------------------------------------------------------------------------ 
| 4. IT INVERSION RESULT: line search its = 0 ; F / FINI = 3.54794e-01
| 
| Fold = 1.90196e-02 
|    F = 1.12762e-02
| 
| 1 Diff parameter value = -1.36120e-01
| 2 Diff parameter value = 2.88970e-03
| 
| 1 Parameter value = 2.05101e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.66200e+00
| LS factor for 2.Parameter = 2.66200e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 3.23671e+20 [Pa*s]  Bd = 1.54478e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113787 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953462556e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785682329e+02 
    1 KSP Residual norm 5.651199950633e-02 
    2 KSP Residual norm 6.053008492040e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258384341546e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0732655 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.287457139535e-10 
      |Div|_2   = 4.258291472965e-09 
   Momentum: 
      |mRes|_2  = 2.812350606418e-11 
--------------------------------------------------------------------------
Saving output ... done (0.030758 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.569367876123e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.278744908582e-01 
    1 KSP Residual norm 5.148891169252e-06 
    2 KSP Residual norm 1.562992259343e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 5.395507144583e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0625463 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.780040496731e-13 
      |Div|_2   = 4.836744176320e-12 
   Momentum: 
      |mRes|_2  = 5.395290347870e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 1.481664506078e-03 
    1 KSP Residual norm 3.197107237021e-07 
    2 KSP Residual norm 5.482147480035e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8780e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307789 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.250636 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.4327743295e-03
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            4.221933e-02 
|  adjoint     2:          rho[ 1]           -9.484705e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -2.65123e-01 
| 
| AdjointOptimisation: Gradients. [0]=4.221933e-02, [1]=-9.484705e-04 

| ------------------------------------------------------------------------ 
| 5. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.39473e-01
| 
| Fold = 1.12762e-02 
|    F = 4.43277e-03
| 
| 1 Diff parameter value = -1.12388e-01
| 2 Diff parameter value = 2.52483e-03
| 
| 1 Parameter value = 2.03977e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.92820e+00
| LS factor for 2.Parameter = 2.92820e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.49871e+20 [Pa*s]  Bd = 2.00103e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113937 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953506755e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785729656e+02 
    1 KSP Residual norm 5.651200326042e-02 
    2 KSP Residual norm 6.053677652530e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258856997603e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0642798 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288034273362e-10 
      |Div|_2   = 4.258763915830e-09 
   Momentum: 
      |mRes|_2  = 2.815733037430e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305694 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570407206017e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.260367821916e-01 
    1 KSP Residual norm 6.627660704996e-06 
    2 KSP Residual norm 1.959734181781e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.046284649329e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0546432 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.287503849194e-12 
      |Div|_2   = 6.793975910974e-12 
   Momentum: 
      |mRes|_2  = 7.045957106632e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 6.880360437373e-04 
    1 KSP Residual norm 1.751998324271e-07 
    2 KSP Residual norm 2.937002211494e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.8739e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0306916 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.233404 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 8.1369134860e-04
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            2.050246e-02 
|  adjoint     2:          rho[ 1]           -4.885138e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.19350e-01 
| 
| AdjointOptimisation: Gradients. [0]=2.050246e-02, [1]=-4.885138e-04 

| ------------------------------------------------------------------------ 
| 6. IT INVERSION RESULT: line search its = 0 ; F / FINI = 2.56020e-02
| 
| Fold = 4.43277e-03 
|    F = 8.13691e-04
| 
| 1 Diff parameter value = -6.00353e-02
| 2 Diff parameter value = 1.43047e-03
| 
| 1 Parameter value = 2.03377e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.22102e+00
| LS factor for 2.Parameter = 3.22102e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.17611e+20 [Pa*s]  Bd = 2.29768e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113455 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953531796e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785756470e+02 
    1 KSP Residual norm 5.651200538746e-02 
    2 KSP Residual norm 6.054059765336e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259124650801e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.075622 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288361289337e-10 
      |Div|_2   = 4.259031586124e-09 
   Momentum: 
      |mRes|_2  = 2.815562917469e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0307068 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570886656609e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.251448023987e-01 
    1 KSP Residual norm 7.611879794852e-06 
    2 KSP Residual norm 2.208613004067e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.557023385544e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0468106 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.570276189893e-12 
      |Div|_2   = 8.141921015686e-12 
   Momentum: 
      |mRes|_2  = 8.556636029011e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 1.601695711349e-04 
    1 KSP Residual norm 4.414518588204e-08 
    2 KSP Residual norm 7.353687860923e-13 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.9006e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307975 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.237261 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.9639046960e-05
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            4.791347e-03 
|  adjoint     2:          rho[ 1]           -1.184078e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.51028e-01 
| 
| AdjointOptimisation: Gradients. [0]=4.791347e-03, [1]=-1.184078e-04 

| ------------------------------------------------------------------------ 
| 7. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.24720e-03
| 
| Fold = 8.13691e-04 
|    F = 3.96390e-05
| 
| 1 Diff parameter value = -1.54330e-02
| 2 Diff parameter value = 3.81394e-04
| 
| 1 Parameter value = 2.03222e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.54312e+00
| LS factor for 2.Parameter = 3.54312e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.10014e+20 [Pa*s]  Bd = 2.3808e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00113771 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953538472e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785763619e+02 
    1 KSP Residual norm 5.651200595462e-02 
    2 KSP Residual norm 6.054161872229e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259195827024e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.077021 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288448453771e-10 
      |Div|_2   = 4.259102948585e-09 
   Momentum: 
      |mRes|_2  = 2.812767835603e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0305104 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.571002906159e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249310668356e-01 
    1 KSP Residual norm 7.890722417669e-06 
    2 KSP Residual norm 2.276965182886e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 9.073605614485e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0625662 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.651212857851e-12 
      |Div|_2   = 8.527707168139e-12 
   Momentum: 
      |mRes|_2  = 9.073204873045e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 9.808831073243e-06 
    1 KSP Residual norm 2.755903496288e-09 
    2 KSP Residual norm 4.586075557301e-14 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.8923e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0305849 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.253824 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.4429059468e-07
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            2.930138e-04 
|  adjoint     2:          rho[ 1]           -7.313874e-06 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.59459e-01 
| 
| AdjointOptimisation: Gradients. [0]=2.930138e-04, [1]=-7.313874e-06 

| ------------------------------------------------------------------------ 
| 8. IT INVERSION RESULT: line search its = 0 ; F / FINI = 4.53996e-06
| 
| Fold = 3.96390e-05 
|    F = 1.44291e-07
| 
| 1 Diff parameter value = -1.03818e-03
| 2 Diff parameter value = 2.59139e-05
| 
| 1 Parameter value = 2.03212e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.89743e+00
| LS factor for 2.Parameter = 3.89743e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Oct  2 2024 - Time: 12:03:10 	    
     Version : 2.1.4 
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.09512e+20 [Pa*s]  Bd = 2.3865e-21 [1/Pa/s]  

   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 1.    
   Rheology iteration number               : 25  
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00114012 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Schur preconditioner type     : inv_eta 
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953538926e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785764105e+02 
    1 KSP Residual norm 5.651200599318e-02 
    2 KSP Residual norm 6.054168858854e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259200793422e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0645394 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288454365925e-10 
      |Div|_2   = 4.259107795890e-09 
   Momentum: 
      |mRes|_2  = 2.814572218188e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0306194 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.571010634062e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249169515206e-01 
    1 KSP Residual norm 7.909793503582e-06 
    2 KSP Residual norm 2.281480927561e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.993092199918e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0573434 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.656844637616e-12 
      |Div|_2   = 8.554693741013e-12 
   Momentum: 
      |mRes|_2  = 8.992685307389e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.424338594067e-07 
    1 KSP Residual norm 1.525974690269e-10 
    2 KSP Residual norm 2.539214141971e-15 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.8986e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0307737 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.236673 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.4036159207e-10
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -1.620172e-05 
|  adjoint     2:          rho[ 1]            4.046842e-07 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.60030e-01 
| 
| AdjointOptimisation: Gradients. [0]=-1.620172e-05, [1]=4.046842e-07 

| ------------------------------------------------------------------------ 
| 9. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.38555e-08
| 
| Fold = 1.44291e-07 
|    F = 4.40362e-10
| 
| 1 Diff parameter value = 6.31452e-05
| 2 Diff parameter value = -1.57723e-06
| 
| 1 Parameter value = 2.03212e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 4.28718e+00
| LS factor for 2.Parameter = 4.28718e+00
| 
| ------------------------------------------------------------------------- 
| *                         INVERSION RESULT SUMMARY                      * 
| ------------------------------------------------------------------------- 
| Number of inversion iterations: 10
| F/Fini:
| 1.00000e+00
| 8.13540e-01
| 5.98434e-01
| 3.54794e-01
| 1.39473e-01
| 2.56020e-02
| 1.24720e-03
| 4.53996e-06
| 1.38555e-08
| 
| Final cost function:
| 4.40362e-10
| 
| Final Parameters: 
| eta[0] = 2.03212e+01
| rho[1] = 3.22001e+03
| ------------------------------------------------------------------------- 

| Adjoint computation was successful & took 2.41966 s                         	 
| ************************************************************************ 
