| ------------------------------------------------------------------------- 
|                                      LaMEM                                
|                        Adjoint Gradient Framework Active                  
| ------------------------------------------------------------------------- 
| Adjoint parameters:  
|    Adjoint mode                             : Gradient descent (or Quasi-Newton) inversion  
|    Use Tao BLMVM (or LaMEM steepest descent): 0    
|    Gradient evaluation points               : several observation points  
|    Advect evaluation points with flow       : 0    
|    Objective function type                  : 0    
|    Objective function defined in input      : 1    
|    Maximum gradient descent iterations      : 200    
|    Maximum linesearch iterations            : 100    
|    Apply bounds                             : 0    
|    Tolerance (F/Fini)                       : 1.00000e-08  
|    Not employing TAO, but instead our build-in gradient algorithm, with the following parameters: 
|     Linesearch factor (successful update)    : 1.10000e+00  
|     Linesearch factor (overstep)             : 4.00000e-01  
|     Maximum linesearch factor                : 5.00000e+00  
|     Scale for initial parameter update       : 1.00000e-01  
|   1 : adjoint log10    eta[0 ] = 21       ; bnd=[-        ; -        ]   
|   2 : adjoint          rho[1 ] = 3220     ; bnd=[-        ; -        ]   
|   Total number of adjoint gradients      : 2   
|   Total number of FD gradients           : 0   
| 
|   Total number of observation points     : 1   
|       [600.000000,0.000000,-20.000000] has target velocity Vx=-0.36000
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 1e+21 [Pa*s]  Bd = 5e-22 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000796352 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953289089e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785496583e+02 
    1 KSP Residual norm 5.651198477633e-02 
    2 KSP Residual norm 6.050386176328e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256529991267e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0546856 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285191998335e-10 
      |Div|_2   = 4.256437299606e-09 
   Momentum: 
      |mRes|_2  = 2.809058703210e-11 
--------------------------------------------------------------------------
Saving output ... done (0.026937 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.561046100810e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.351152880402e-01 
    1 KSP Residual norm 1.963879999092e-06 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 1
  1 SNES Function norm 2.167957499904e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0345542 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.086431098139e-09 
      |Div|_2   = 1.893580327016e-08 
   Momentum: 
      |mRes|_2  = 2.167874801908e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.396469141955e-03 
    1 KSP Residual norm 3.179500098984e-07 
    2 KSP Residual norm 6.679707134766e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 3 markers in 1.7868e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0234056 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.193338 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.1782342164e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.323656e-02 
|  adjoint     2:          rho[ 1]           -1.027791e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.05957e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.323656e-02, [1]=-1.027791e-03 

| ------------------------------------------------------------------------ 
| 1. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.00000e+00
| 
| Fold = 1.00000e+100 
|    F = 3.17823e-02
| 
| 1 Diff parameter value = -2.10000e+00
| 2 Diff parameter value = 3.22000e+02
| 
| 1 Parameter value = 1.89000e+01
| 2 Parameter value = 3.54200e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 5.00000e+00
| LS factor for 2.Parameter = 5.00000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.94328e+18 [Pa*s]  Bd = 6.29463e-20 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3542. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00076228 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.381750838666e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.737605410276e+02 
    1 KSP Residual norm 2.571084654771e-01 
    2 KSP Residual norm 2.661014248525e-04 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.148503048444e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0502628 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.172403615885e-07 
      |Div|_2   = 4.145787015691e-06 
   Momentum: 
      |mRes|_2  = 1.500918501285e-07 
--------------------------------------------------------------------------
Saving output ... done (0.0266641 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 7.184900751098e+02 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 4.026133102563e+01 
    1 KSP Residual norm 8.097653805178e-03 
    2 KSP Residual norm 4.635565695720e-07 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.220234278755e-06 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < rtol*||F_initial|| 
Number of iterations    : 1
SNES solution time      : 0.0357581 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 7.974959666963e-09 
      |Div|_2   = 3.814144083472e-08 
   Momentum: 
      |mRes|_2  = 4.220061918748e-06 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.885429313468e+00 
    1 KSP Residual norm 1.824544953076e-03 
    2 KSP Residual norm 3.456464996101e-08 
Actual time step : 0.05140 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 44 markers in 2.0141e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0264048 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.186571 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 9.7357846376e+01
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -4.110339e+01 
|  adjoint     2:          rho[ 1]            5.812966e-01 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.44209e+01 
| 
| AdjointOptimisation: Gradients. [0]=-4.110339e+01, [1]=5.812966e-01 

| - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|               LINE SEARCH IT 1                       
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 7.82577e+20 [Pa*s]  Bd = 6.38915e-22 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000769731 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953325073e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785535114e+02 
    1 KSP Residual norm 5.651198783153e-02 
    2 KSP Residual norm 6.050932821478e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.256914405929e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0490728 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.285661829757e-10 
      |Div|_2   = 4.256821922482e-09 
   Momentum: 
      |mRes|_2  = 2.806028650913e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0240396 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.563590442027e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.338414978662e-01 
    1 KSP Residual norm 2.373072389963e-06 
    2 KSP Residual norm 7.395627587947e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.281241421559e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0358793 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 2.692017073667e-13 
      |Div|_2   = 1.504658562542e-12 
   Momentum: 
      |mRes|_2  = 2.281191798972e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 3.115020858345e-03 
    1 KSP Residual norm 3.487341569591e-07 
    2 KSP Residual norm 7.020035398099e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.7596e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0239054 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.178347 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 2.5856199609e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.776753e-02 
|  adjoint     2:          rho[ 1]           -1.141286e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.30861e-01 
| 
|    F = 2.585620e-02,  Fold = 3.178234e-02                      

| - - - - - - - - - - - - - - - - - - - - - - - - - - - 

| ------------------------------------------------------------------------ 
| 2. IT INVERSION RESULT: line search its = 1 ; F / FINI = 8.13540e-01
| 
| Fold = 3.17823e-02 
|    F = 2.58562e-02
| 
| 1 Diff parameter value = -1.15535e-01
| 2 Diff parameter value = 2.28257e-03
| 
| 1 Parameter value = 2.07780e+01
| 2 Parameter value = 3.22000e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.20000e+00
| LS factor for 2.Parameter = 2.20000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 5.9978e+20 [Pa*s]  Bd = 8.33639e-22 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00076342 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953365031e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785577900e+02 
    1 KSP Residual norm 5.651199122448e-02 
    2 KSP Residual norm 6.051543362271e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.257341817529e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0487247 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.286183576032e-10 
      |Div|_2   = 4.257249016732e-09 
   Momentum: 
      |mRes|_2  = 2.810979919534e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0241021 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.565805797359e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.322389656259e-01 
    1 KSP Residual norm 2.950119676629e-06 
    2 KSP Residual norm 9.189499568620e-11 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 2.768060885556e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0357031 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 3.807033085047e-13 
      |Div|_2   = 2.144291561943e-12 
   Momentum: 
      |mRes|_2  = 2.767977830025e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.741663667695e-03 
    1 KSP Residual norm 3.756535233984e-07 
    2 KSP Residual norm 7.161228530626e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.7692e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0242045 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.177089 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.9019648383e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.989479e-02 
|  adjoint     2:          rho[ 1]           -1.218837e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -1.63473e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.989479e-02, [1]=-1.218837e-03 

| ------------------------------------------------------------------------ 
| 3. IT INVERSION RESULT: line search its = 0 ; F / FINI = 5.98434e-01
| 
| Fold = 2.58562e-02 
|    F = 1.90196e-02
| 
| 1 Diff parameter value = -1.31769e-01
| 2 Diff parameter value = 2.68144e-03
| 
| 1 Parameter value = 2.06462e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.42000e+00
| LS factor for 2.Parameter = 2.42000e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 4.42816e+20 [Pa*s]  Bd = 1.12914e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.0007618 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953411971e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785628162e+02 
    1 KSP Residual norm 5.651199521060e-02 
    2 KSP Residual norm 6.052251550285e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.257843324849e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0491475 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.286796512383e-10 
      |Div|_2   = 4.257750754731e-09 
   Momentum: 
      |mRes|_2  = 2.807649473512e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0240536 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.567786554354e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.301659533583e-01 
    1 KSP Residual norm 3.845918604765e-06 
    2 KSP Residual norm 1.189278232926e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 3.399563269175e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0356823 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 5.559269678716e-13 
      |Div|_2   = 3.202057231359e-12 
   Momentum: 
      |mRes|_2  = 3.399412464540e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 2.205989855877e-03 
    1 KSP Residual norm 3.804385359849e-07 
    2 KSP Residual norm 6.833652140575e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.7531e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0481156 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.201624 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.1276181351e-02
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            5.624777e-02 
|  adjoint     2:          rho[ 1]           -1.194090e-03 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -2.08677e-01 
| 
| AdjointOptimisation: Gradients. [0]=5.624777e-02, [1]=-1.194090e-03 

| ------------------------------------------------------------------------ 
| 4. IT INVERSION RESULT: line search its = 0 ; F / FINI = 3.54794e-01
| 
| Fold = 1.90196e-02 
|    F = 1.12762e-02
| 
| 1 Diff parameter value = -1.36120e-01
| 2 Diff parameter value = 2.88970e-03
| 
| 1 Parameter value = 2.05101e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.66200e+00
| LS factor for 2.Parameter = 2.66200e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 3.23671e+20 [Pa*s]  Bd = 1.54478e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000777431 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953462556e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785682329e+02 
    1 KSP Residual norm 5.651199950680e-02 
    2 KSP Residual norm 6.053024281477e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258384234789e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0570019 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.287457030031e-10 
      |Div|_2   = 4.258291461001e-09 
   Momentum: 
      |mRes|_2  = 2.810914917500e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0244052 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.569367876119e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.278744908779e-01 
    1 KSP Residual norm 5.148910391404e-06 
    2 KSP Residual norm 1.563339899021e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 5.088449677242e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0356962 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.781281095067e-13 
      |Div|_2   = 4.837447689985e-12 
   Momentum: 
      |mRes|_2  = 5.088219730693e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 1.481664509677e-03 
    1 KSP Residual norm 3.197107169346e-07 
    2 KSP Residual norm 5.482176805934e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.7716e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.023898 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.194213 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.4327743496e-03
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            4.221933e-02 
|  adjoint     2:          rho[ 1]           -9.484705e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -2.65123e-01 
| 
| AdjointOptimisation: Gradients. [0]=4.221933e-02, [1]=-9.484705e-04 

| ------------------------------------------------------------------------ 
| 5. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.39473e-01
| 
| Fold = 1.12762e-02 
|    F = 4.43277e-03
| 
| 1 Diff parameter value = -1.12388e-01
| 2 Diff parameter value = 2.52483e-03
| 
| 1 Parameter value = 2.03977e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 2.92820e+00
| LS factor for 2.Parameter = 2.92820e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.49871e+20 [Pa*s]  Bd = 2.00103e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000769381 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953506755e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785729656e+02 
    1 KSP Residual norm 5.651200326090e-02 
    2 KSP Residual norm 6.053691944241e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.258857111427e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0491171 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288034167110e-10 
      |Div|_2   = 4.258763904529e-09 
   Momentum: 
      |mRes|_2  = 2.817624940288e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0239819 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570407206010e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.260367822102e-01 
    1 KSP Residual norm 6.627698884957e-06 
    2 KSP Residual norm 1.960145985228e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 7.006367477323e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0353477 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.287632272941e-12 
      |Div|_2   = 6.794580703672e-12 
   Momentum: 
      |mRes|_2  = 7.006038009788e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 6.880360514426e-04 
    1 KSP Residual norm 1.751998516489e-07 
    2 KSP Residual norm 2.936998489079e-12 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 4 markers in 1.7671e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0239839 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.176622 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 8.1369136863e-04
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            2.050246e-02 
|  adjoint     2:          rho[ 1]           -4.885138e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.19350e-01 
| 
| AdjointOptimisation: Gradients. [0]=2.050246e-02, [1]=-4.885138e-04 

| ------------------------------------------------------------------------ 
| 6. IT INVERSION RESULT: line search its = 0 ; F / FINI = 2.56020e-02
| 
| Fold = 4.43277e-03 
|    F = 8.13691e-04
| 
| 1 Diff parameter value = -6.00353e-02
| 2 Diff parameter value = 1.43047e-03
| 
| 1 Parameter value = 2.03377e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.22102e+00
| LS factor for 2.Parameter = 3.22102e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.17611e+20 [Pa*s]  Bd = 2.29768e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.000783511 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953531796e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785756470e+02 
    1 KSP Residual norm 5.651200538795e-02 
    2 KSP Residual norm 6.054071640769e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259124545623e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0489711 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288361193927e-10 
      |Div|_2   = 4.259031573629e-09 
   Momentum: 
      |mRes|_2  = 2.814160554858e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0240206 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.570886656606e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.251448024169e-01 
    1 KSP Residual norm 7.611930702532e-06 
    2 KSP Residual norm 2.208514338712e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.552694232060e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0352015 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.570167661256e-12 
      |Div|_2   = 8.141290222884e-12 
   Momentum: 
      |mRes|_2  = 8.552306739498e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 1.601695759145e-04 
    1 KSP Residual norm 4.414518548665e-08 
    2 KSP Residual norm 7.353722312688e-13 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.7651e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0239129 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.176309 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 3.9639049359e-05
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            4.791347e-03 
|  adjoint     2:          rho[ 1]           -1.184078e-04 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.51028e-01 
| 
| AdjointOptimisation: Gradients. [0]=4.791347e-03, [1]=-1.184078e-04 

| ------------------------------------------------------------------------ 
| 7. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.24720e-03
| 
| Fold = 8.13691e-04 
|    F = 3.96390e-05
| 
| 1 Diff parameter value = -1.54330e-02
| 2 Diff parameter value = 3.81394e-04
| 
| 1 Parameter value = 2.03222e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.54312e+00
| LS factor for 2.Parameter = 3.54312e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.10014e+20 [Pa*s]  Bd = 2.3808e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00076383 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953538472e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785763619e+02 
    1 KSP Residual norm 5.651200595513e-02 
    2 KSP Residual norm 6.054180120860e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259195896817e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0488836 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288448339929e-10 
      |Div|_2   = 4.259102936995e-09 
   Momentum: 
      |mRes|_2  = 2.813999887816e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0239475 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.571002906160e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249310668140e-01 
    1 KSP Residual norm 7.890700739022e-06 
    2 KSP Residual norm 2.277605433317e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 8.931829177850e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.035543 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.651537630612e-12 
      |Div|_2   = 8.529351109087e-12 
   Momentum: 
      |mRes|_2  = 8.931421918108e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 9.808830977820e-06 
    1 KSP Residual norm 2.755903324499e-09 
    2 KSP Residual norm 4.586097069030e-14 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.7692e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0239856 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.176672 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 1.4429059166e-07
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]            2.930138e-04 
|  adjoint     2:          rho[ 1]           -7.313874e-06 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.59459e-01 
| 
| AdjointOptimisation: Gradients. [0]=2.930138e-04, [1]=-7.313874e-06 

| ------------------------------------------------------------------------ 
| 8. IT INVERSION RESULT: line search its = 0 ; F / FINI = 4.53996e-06
| 
| Fold = 3.96390e-05 
|    F = 1.44291e-07
| 
| 1 Diff parameter value = -1.03818e-03
| 2 Diff parameter value = 2.59139e-05
| 
| 1 Parameter value = 2.03212e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 3.89743e+00
| LS factor for 2.Parameter = 3.89743e+00
| 
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Apr 16 2023 - Time: 22:17:59 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
   Adding PETSc option: -js_ksp_monitor
Finished parsing input file : t7_Subduction2D_FreeSlip_Inversion.dat 
--------------------------------------------------------------------------
Scaling parameters:
   Temperature : 1000. [C/K] 
   Length      : 10000. [m] 
   Viscosity   : 1e+20 [Pa*s] 
   Stress      : 1e+09 [Pa] 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 100. [Myr] 
   Maximum number of steps      : 1 
   Time step                    : 0.1 [Myr] 
   Minimum time step            : 1e-05 [Myr] 
   Maximum time step            : 100. [Myr] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.5 [Myr] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Material parameters: 
--------------------------------------------------------------------------
- Melt factor mfc = 0.000000   Phase ID : 0     --   Mantle 
   (dens)   : rho = 3200. [kg/m^3]  
   (diff)   : eta = 2.09512e+20 [Pa*s]  Bd = 2.3865e-21 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 1     --   Slab 
   (dens)   : rho = 3220.01 [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

- Melt factor mfc = 0.000000   Phase ID : 2     --   PlasticCrust 
   (dens)   : rho = 3220. [kg/m^3]  
   (diff)   : eta = 1e+23 [Pa*s]  Bd = 5e-24 [1/Pa/s]  

--------------------------------------------------------------------------
--------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 1 
   Processor grid  [nx, ny, nz]         : [1, 1, 1]
   Fine grid cells [nx, ny, nz]         : [64, 2, 16]
   Number of cells                      :  2048
   Number of faces                      :  7328
   Maximum cell aspect ratio            :  4.68750
   Lower coordinate bounds [bx, by, bz] : [-1500., -10., -660.]
   Upper coordinate bounds [ex, ey, ez] : [1500., 10., 0.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 1 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -9.81] [m/s^2] 
   Surface stabilization (FSSA)            :  1. 
   Compute initial guess                   @ 
   Use lithostatic pressure for creep      @ 
   Use lithostatic pressure for plasticity @ 
   Minimum viscosity                       : 1e+17 [Pa*s] 
   Maximum viscosity                       : 1e+23 [Pa*s] 
   Reference viscosity (initial guess)     : 1e+20 [Pa*s] 
   Max. melt fraction (viscosity, density) : 0.15    
   Rheology iteration number               : 25    
   Rheology iteration tolerance            : 1e-06    
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Runge-Kutta 2-nd order
   Periodic marker advection     : 0 0 0 
   Marker setup scheme           : geometric primitives
   Velocity interpolation scheme : empirical STAGP (STAG + pressure points)
   Marker control type           : AVD for cells + corner insertion
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : random noise
   Background phase ID           : 0 
   Interpolation constant        : 0.7 
--------------------------------------------------------------------------
Reading geometric primitives ... done (0.00076387 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : Subduction2D_direct 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Velocity                                @ 
   Pressure                                @ 
   Temperature                             @ 
   Deviatoric stress tensor                @ 
   Deviatoric stress second invariant      @ 
   Deviatoric strain rate tensor           @ 
   Deviatoric strain rate second invariant @ 
   Yield stress                            @ 
   Accumulated Plastic Strain (APS)        @ 
   Plastic dissipation                     @ 
   Total displacements                     @ 
   Momentum residual                       @ 
   Continuity residual                     @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Solver parameters specified: 
   Outermost Krylov solver       : gmres 
   Solver type                   : serial direct/lu 
   Solver package                : petsc 
--------------------------------------------------------------------------
============================== INITIAL GUESS =============================
--------------------------------------------------------------------------
  0 SNES Function norm 1.375953538926e+01 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.701785764105e+02 
    1 KSP Residual norm 5.651200599364e-02 
    2 KSP Residual norm 6.054185252272e-08 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 4.259200538214e-09 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0485795 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 4.288454268347e-10 
      |Div|_2   = 4.259107785703e-09 
   Momentum: 
      |mRes|_2  = 2.810861945602e-11 
--------------------------------------------------------------------------
Saving output ... done (0.0238442 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000000 [Myr] 
Tentative time step : 0.10000000 [Myr] 
--------------------------------------------------------------------------
  0 SNES Function norm 1.571010634064e+00 
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 2.249169515259e-01 
    1 KSP Residual norm 7.909876707455e-06 
    2 KSP Residual norm 2.282202847036e-10 
  Linear js_ solve converged due to CONVERGED_RTOL iterations 2
  1 SNES Function norm 9.174763301613e-10 
--------------------------------------------------------------------------
SNES Convergence Reason : ||F|| < atol 
Number of iterations    : 1
SNES solution time      : 0.0354957 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 1.657082023682e-12 
      |Div|_2   = 8.555845370457e-12 
   Momentum: 
      |mRes|_2  = 9.174364358997e-10 
--------------------------------------------------------------------------
    Residual norms for as_ solve.
    0 KSP Residual norm 5.424339260075e-07 
    1 KSP Residual norm 1.525975147267e-10 
    2 KSP Residual norm 2.539216767873e-15 
Actual time step : 0.11000 [Myr] 
--------------------------------------------------------------------------
Performing marker control (standard algorithm)
Marker control [0]: (Corners ) injected 6 markers in 1.7701e-03 s 
--------------------------------------------------------------------------
Saving output ... done (0.0241832 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
Total solution time : 0.176409 (sec) 
--------------------------------------------------------------------------
| ************************************************************************
|                       COMPUTATION OF THE COST FUNCTION                    
| ************************************************************************
| Current Cost function = 4.4036169827e-10
| ************************************************************************ 
|                       COMPUTATION OF THE GRADIENTS                       
| ************************************************************************ 
| 
| Gradients: 
|                    Parameter             |  Gradient (dimensional)  
|                  -----------------------   ------------------------ 
|  adjoint     1:   log10  eta[ 0]           -1.620173e-05 
|  adjoint     2:          rho[ 1]            4.046843e-07 
| 
| 
| Observation points: 
|                                                   Velocity [cm/yr]       
|                       Location         |      Target         Value     
|       --------------------------------- --- ------------- ------------- 
| 1   : [  600.000;     0.000;   -20.000]  Vx -3.60000e-01  -3.60030e-01 
| 
| AdjointOptimisation: Gradients. [0]=-1.620173e-05, [1]=4.046843e-07 

| ------------------------------------------------------------------------ 
| 9. IT INVERSION RESULT: line search its = 0 ; F / FINI = 1.38555e-08
| 
| Fold = 1.44291e-07 
|    F = 4.40362e-10
| 
| 1 Diff parameter value = 6.31452e-05
| 2 Diff parameter value = -1.57723e-06
| 
| 1 Parameter value = 2.03212e+01
| 2 Parameter value = 3.22001e+03
| -------------------------------------------------------------------------

| LS factor for 1.Parameter = 4.28718e+00
| LS factor for 2.Parameter = 4.28718e+00
| 
| ------------------------------------------------------------------------- 
| *                         INVERSION RESULT SUMMARY                      * 
| ------------------------------------------------------------------------- 
| Number of inversion iterations: 10
| F/Fini:
| 1.00000e+00
| 8.13540e-01
| 5.98434e-01
| 3.54794e-01
| 1.39473e-01
| 2.56020e-02
| 1.24720e-03
| 4.53996e-06
| 1.38555e-08
| 
| Final cost function:
| 4.40362e-10
| 
| Final Parameters: 
| eta[0] = 2.03212e+01
| rho[1] = 3.22001e+03
| ------------------------------------------------------------------------- 

| Adjoint computation was successful & took 1.83855 s                         	 
| ************************************************************************ 
