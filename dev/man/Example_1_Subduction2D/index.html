<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>4.1 2D subduction setup with nonlinear rheologies · LaMEM</title><meta name="title" content="4.1 2D subduction setup with nonlinear rheologies · LaMEM"/><meta property="og:title" content="4.1 2D subduction setup with nonlinear rheologies · LaMEM"/><meta property="twitter:title" content="4.1 2D subduction setup with nonlinear rheologies · LaMEM"/><meta name="description" content="Documentation for LaMEM."/><meta property="og:description" content="Documentation for LaMEM."/><meta property="twitter:description" content="Documentation for LaMEM."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../Home/">LaMEM</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../Home/">Home</a></li><li><a class="tocitem" href="../Quickstart/">Quick start</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../Installation/">Installation</a></li><li><a class="tocitem" href="../GettingStarted/">Getting Started</a></li><li><a class="tocitem" href="../InitialModelSetup/">Initial Model setup</a></li></ul></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../LaMEM_Development/">LaMEM Development</a></li><li><a class="tocitem" href="../Debugging/">LaMEM Debugging</a></li></ul></li><li><a class="tocitem" href="../CODE_OF_CONDUCT/">Code of conduct</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>4.1 2D subduction setup with nonlinear rheologies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>4.1 2D subduction setup with nonlinear rheologies</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/UniMainzGeo/LaMEM" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/UniMainzGeo/LaMEM/blob/master/docs/src/man/Example_1_Subduction2D.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="4.1-2D-subduction-setup-with-nonlinear-rheologies"><a class="docs-heading-anchor" href="#4.1-2D-subduction-setup-with-nonlinear-rheologies">4.1 2D subduction setup with nonlinear rheologies</a><a id="4.1-2D-subduction-setup-with-nonlinear-rheologies-1"></a><a class="docs-heading-anchor-permalink" href="#4.1-2D-subduction-setup-with-nonlinear-rheologies" title="Permalink"></a></h1><p>This is a worked-out example of how to create a 2D subduction setup with temperature dependent rheology.</p><p>The example input file can be found under:</p><pre><code class="nohighlight hljs">/input_models/SubductionWithParticles/Subduction2D_FreeSurface_MATLABParticles_Nonlinear_DirectSolver.dat</code></pre><p>whereas the MATLAB/Octave file is here:</p><pre><code class="nohighlight hljs">/input_models/SubductionWithParticles/CreateMarkers_Subduction_Tdependent_FreeSurface_parallel.m</code></pre><h3 id="4.1.1-Input-model-geometry"><a class="docs-heading-anchor" href="#4.1.1-Input-model-geometry">4.1.1 Input model geometry</a><a id="4.1.1-Input-model-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#4.1.1-Input-model-geometry" title="Permalink"></a></h3><p>We start with having a look at the input file. With Visual Studio Code this can be done with</p><pre><code class="nohighlight hljs">$ code Subduction2D_FreeSurface_MATLABParticles_Nonlinear_DirectSolver.dat</code></pre><p>***Units*** At the beginning of the script, we specify the units</p><pre><code class="nohighlight hljs">#===============================================================================
# Scaling
#===============================================================================

	units            = geo		# geological units 
	
	unit_temperature = 1000
	unit_length      = 1e3
	unit_viscosity   = 1e20
	unit_stress      = 1e9</code></pre><p>Internally, LaMEM computes everything in non-dimensional units in order to preent round-off (numerical) errors. In order to transfer things from dimensional to non-dimensional units you need to specify these values. LaMEM has 3 modes for units</p><pre><code class="nohighlight hljs">units = none
units = SI
units = geo</code></pre><p>as you can imagine, the first implies that all input is in non-dimensional units, the second that all is given in SI units. The third, and the one that is most typically used, employs geodynamically sensible units, such as temperature in celcius, length scales in kilometers, times in million years, etc.</p><p>The units that you define here are in SI-units, which implies that the typical lengthscale is 1000 meters, and the typical stress is <span>$10^9$</span> Pa.</p><p>***Model domain*** The model domain and numerical reoslution are specified here:</p><pre><code class="nohighlight hljs">#===============================================================================
# Grid &amp; discretization parameters
#===============================================================================

# Number of cells for all segments
	nel_x = 256
	nel_y = 2
	nel_z = 64

# Coordinates of all segments (including start and end points)

	coord_x = -1500 1500
	coord_y = -10   10
	coord_z = -660  40</code></pre><p>Note that LaMEM is a fully 3D code; there is no pure-2D part. Yet you can nevertheless do 2D simulations by selecting only 1 or 2 cells in the y-direction as done above. If you select multigrid as a solver, you need to have at least 2 cells here. Note that for 2D, the &#39;thin&#39; direction should always be the y-direction.</p><p>The remaining part of this block defines the number of elements in each direction and the left/right, front/back and bottom/top coordinates (in km, as we use geo units).</p><p>Also note that you can always specify parameters on the command-line, that will <em>overrule</em> whatever is written in the input file.  For example: </p><pre><code class="nohighlight hljs">../../bin/LaMEM -ParamFile Subduction2D_FreeSurface_MATLABParticles_Nonlinear_DirectSolver.dat -nel_x 64 -nel_z 16</code></pre><p>will perform a simulation with 64 by 2 by 16 elements instead.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 31 October 2025 12:44">Friday 31 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
